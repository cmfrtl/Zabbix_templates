# Config file for zabbix agent to monitor FreeRadius service
# Created by Eloy Garcia on July of 2017.
#

#If freeradius service is running, it will return: rad_recv: Access-Accept packet from host 127.0.0.1 port 18121, id=129, length=140
#If freeradius service is not running, it will return: radclient: radclient: no response from server for ID 71 socket 3
#Values for id, length, ID and socket may change.

#It is recommended to comment out the lines (keys) that you don't want to collect.

UserParameter=radius.auth_status,echo "Message-Authenticator = 0x00, FreeRADIUS-Statistics-Type = 1" | radclient -x 127.0.0.1:18121 status adminsecret | grep 'rad_recv\|radclient'
UserParameter=radius.auth_access_requests,echo "Message-Authenticator = 0x00, FreeRADIUS-Statistics-Type = 1" | radclient -x 127.0.0.1:18121 status adminsecret |  grep "FreeRADIUS-Total-Access-Requests" | rev |cut -d ' ' -f 1 | rev
UserParameter=radius.auth_access_accepts,echo "Message-Authenticator = 0x00, FreeRADIUS-Statistics-Type = 1" | radclient -x 127.0.0.1:18121 status adminsecret |  grep "FreeRADIUS-Total-Access-Accepts" | rev |cut -d ' ' -f 1 | rev
UserParameter=radius.auth_access_rejects,echo "Message-Authenticator = 0x00, FreeRADIUS-Statistics-Type = 1" | radclient -x 127.0.0.1:18121 status adminsecret |  grep "FreeRADIUS-Total-Access-Rejects" | rev |cut -d ' ' -f 1 | rev
UserParameter=radius.auth_access_challenges,echo "Message-Authenticator = 0x00, FreeRADIUS-Statistics-Type = 1" | radclient -x 127.0.0.1:18121 status adminsecret |  grep "FreeRADIUS-Total-Access-Challenges" | rev |cut -d ' ' -f 1 | rev
UserParameter=radius.auth_responses,echo "Message-Authenticator = 0x00, FreeRADIUS-Statistics-Type = 1" | radclient -x 127.0.0.1:18121 status adminsecret |  grep "FreeRADIUS-Total-Auth-Responses" | rev |cut -d ' ' -f 1 | rev
UserParameter=radius.auth_duplicated_requests,echo "Message-Authenticator = 0x00, FreeRADIUS-Statistics-Type = 1" | radclient -x 127.0.0.1:18121 status adminsecret |  grep "FreeRADIUS-Total-Auth-Duplicate-Requests" | rev |cut -d ' ' -f 1 | rev
UserParameter=radius.auth_malformed_requests,echo "Message-Authenticator = 0x00, FreeRADIUS-Statistics-Type = 1" | radclient -x 127.0.0.1:18121 status adminsecret |  grep "FreeRADIUS-Total-Auth-Malformed-Requests" | rev |cut -d ' ' -f 1 | rev
UserParameter=radius.auth_invalid_requests,echo "Message-Authenticator = 0x00, FreeRADIUS-Statistics-Type = 1" | radclient -x 127.0.0.1:18121 status adminsecret |  grep "FreeRADIUS-Total-Auth-Invalid-Requests" | rev |cut -d ' ' -f 1 | rev
UserParameter=radius.auth_dropped_requests,echo "Message-Authenticator = 0x00, FreeRADIUS-Statistics-Type = 1" | radclient -x 127.0.0.1:18121 status adminsecret |  grep "FreeRADIUS-Total-Auth-Dropped-Requests" | rev |cut -d ' ' -f 1 | rev
UserParameter=radius.auth_unknown_types,echo "Message-Authenticator = 0x00, FreeRADIUS-Statistics-Type = 1" | radclient -x 127.0.0.1:18121 status adminsecret |  grep "FreeRADIUS-Total-Auth-Unknown-Types" | rev |cut -d ' ' -f 1 | rev
UserParameter=radius.acct_requests,echo "Message-Authenticator = 0x00, FreeRADIUS-Statistics-Type = 2" | radclient -x 127.0.0.1:18121 status adminsecret |  grep "FreeRADIUS-Total-Accounting-Requests" | rev |cut -d ' ' -f 1 | rev
UserParameter=radius.acct_responses,echo "Message-Authenticator = 0x00, FreeRADIUS-Statistics-Type = 2" | radclient -x 127.0.0.1:18121 status adminsecret |  grep "FreeRADIUS-Total-Accounting-Responses" | rev |cut -d ' ' -f 1 | rev
UserParameter=radius.acct_duplicated_requests,echo "Message-Authenticator = 0x00, FreeRADIUS-Statistics-Type = 2, Response-Packet-Type = Access-Accept" | radclient -x 127.0.0.1:18121 status adminsecret |  grep "FreeRADIUS-Total-Acct-Duplicate-Requests" | rev |cut -d ' ' -f 1 | rev
UserParameter=radius.acct_malformed_requests,echo "Message-Authenticator = 0x00, FreeRADIUS-Statistics-Type = 2" | radclient -x 127.0.0.1:18121 status adminsecret |  grep "FreeRADIUS-Total-Acct-Malformed-Requests" | rev |cut -d ' ' -f 1 | rev
UserParameter=radius.acct_invalid_requests,echo "Message-Authenticator = 0x00, FreeRADIUS-Statistics-Type = 2" | radclient -x 127.0.0.1:18121 status adminsecret |  grep "FreeRADIUS-Total-Acct-Invalid-Requests" | rev |cut -d ' ' -f 1 | rev
UserParameter=radius.acct_dropped_requests,echo "Message-Authenticator = 0x00, FreeRADIUS-Statistics-Type = 2" | radclient -x 127.0.0.1:18121 status adminsecret |  grep "FreeRADIUS-Total-Acct-Dropped-Requests" | rev |cut -d ' ' -f 1 | rev
UserParameter=radius.acct_unknown_types,echo "Message-Authenticator = 0x00, FreeRADIUS-Statistics-Type = 2" | radclient -x 127.0.0.1:18121 status adminsecret |  grep "FreeRADIUS-Total-Acct-Unknown-Types" | rev |cut -d ' ' -f 1 | rev
UserParameter=radius.authacct_access_requests,echo "Message-Authenticator = 0x00, FreeRADIUS-Statistics-Type = 3" | radclient -x 127.0.0.1:18121 status adminsecret |  grep "FreeRADIUS-Total-Access-Requests" | rev |cut -d ' ' -f 1 | rev
UserParameter=radius.authacct_access_accepts,echo "Message-Authenticator = 0x00, FreeRADIUS-Statistics-Type = 3" | radclient -x 127.0.0.1:18121 status adminsecret |  grep "FreeRADIUS-Total-Access-Accepts" | rev |cut -d ' ' -f 1 | rev
UserParameter=radius.authacct_access_rejects,echo "Message-Authenticator = 0x00, FreeRADIUS-Statistics-Type = 3" | radclient -x 127.0.0.1:18121 status adminsecret |  grep "FreeRADIUS-Total-Access-Rejects" | rev |cut -d ' ' -f 1 | rev
UserParameter=radius.authacct_access_challenges,echo "Message-Authenticator = 0x00, FreeRADIUS-Statistics-Type = 3" | radclient -x 127.0.0.1:18121 status adminsecret |  grep "FreeRADIUS-Total-Access-Challenges" | rev |cut -d ' ' -f 1 | rev
UserParameter=radius.authacct_auth_responses,echo "Message-Authenticator = 0x00, FreeRADIUS-Statistics-Type = 3" | radclient -x 127.0.0.1:18121 status adminsecret |  grep "FreeRADIUS-Total-Auth-Responses" | rev |cut -d ' ' -f 1 | rev
UserParameter=radius.authacct_duplicate_requests,echo "Message-Authenticator = 0x00, FreeRADIUS-Statistics-Type = 3" | radclient -x 127.0.0.1:18121 status adminsecret |  grep "FreeRADIUS-Total-Auth-Duplicate-Requests" | rev |cut -d ' ' -f 1 | rev
UserParameter=radius.authacct_malformed_requests,echo "Message-Authenticator = 0x00, FreeRADIUS-Statistics-Type = 3" | radclient -x 127.0.0.1:18121 status adminsecret |  grep "FreeRADIUS-Total-Auth-Malformed-Requests" | rev |cut -d ' ' -f 1 | rev
UserParameter=radius.authacct_invalid_requests,echo "Message-Authenticator = 0x00, FreeRADIUS-Statistics-Type = 3" | radclient -x 127.0.0.1:18121 status adminsecret |  grep "FreeRADIUS-Total-Auth-Invalid-Requests" | rev |cut -d ' ' -f 1 | rev
UserParameter=radius.authacct_dropped_requests,echo "Message-Authenticator = 0x00, FreeRADIUS-Statistics-Type = 3" | radclient -x 127.0.0.1:18121 status adminsecret |  grep "FreeRADIUS-Total-Auth-Dropped-Requests" | rev |cut -d ' ' -f 1 | rev
UserParameter=radius.authacct_auth_unknown_types,echo "Message-Authenticator = 0x00, FreeRADIUS-Statistics-Type = 3" | radclient -x 127.0.0.1:18121 status adminsecret |  grep "FreeRADIUS-Total-Auth-Unknown-Types" | rev |cut -d ' ' -f 1 | rev
UserParameter=radius.authacct_acct_requests,echo "Message-Authenticator = 0x00, FreeRADIUS-Statistics-Type = 3" | radclient -x 127.0.0.1:18121 status adminsecret |  grep "FreeRADIUS-Total-Accounting-Requests" | rev |cut -d ' ' -f 1 | rev
UserParameter=radius.authacct_acct_responses,echo "Message-Authenticator = 0x00, FreeRADIUS-Statistics-Type = 3" | radclient -x 127.0.0.1:18121 status adminsecret |  grep "FreeRADIUS-Total-Accounting-Responses" | rev |cut -d ' ' -f 1 | rev
UserParameter=radius.authacct_acct_duplicate_requests,echo "Message-Authenticator = 0x00, FreeRADIUS-Statistics-Type = 3" | radclient -x 127.0.0.1:18121 status adminsecret |  grep "FreeRADIUS-Total-Acct-Duplicate-Requests" | rev |cut -d ' ' -f 1 | rev
UserParameter=radius.authacct_acct_malformed_requests,echo "Message-Authenticator = 0x00, FreeRADIUS-Statistics-Type = 3" | radclient -x 127.0.0.1:18121 status adminsecret |  grep "FreeRADIUS-Total-Acct-Malformed-Requests" | rev |cut -d ' ' -f 1 | rev
UserParameter=radius.authacct_acct_invalid_requests,echo "Message-Authenticator = 0x00, FreeRADIUS-Statistics-Type = 3" | radclient -x 127.0.0.1:18121 status adminsecret |  grep "FreeRADIUS-Total-Acct-Invalid-Requests" | rev |cut -d ' ' -f 1 | rev
UserParameter=radius.authacct_acct_dropped_requests,echo "Message-Authenticator = 0x00, FreeRADIUS-Statistics-Type = 3" | radclient -x 127.0.0.1:18121 status adminsecret |  grep "FreeRADIUS-Total-Acct-Dropped-Requests" | rev |cut -d ' ' -f 1 | rev
UserParameter=radius.authacct_acct_unknown_types,echo "Message-Authenticator = 0x00, FreeRADIUS-Statistics-Type = 3" | radclient -x 127.0.0.1:18121 status adminsecret |  grep "FreeRADIUS-Total-Acct-Unknown-Types" | rev |cut -d ' ' -f 1 | rev
UserParameter=radius.proxyauth_access_requests,echo "Message-Authenticator = 0x00, FreeRADIUS-Statistics-Type = 4" | radclient -x 127.0.0.1:18121 status adminsecret |  grep "FreeRADIUS-Total-Proxy-Access-Requests" | rev |cut -d ' ' -f 1 | rev
UserParameter=radius.proxyauth_access_accepts,echo "Message-Authenticator = 0x00, FreeRADIUS-Statistics-Type = 4" | radclient -x 127.0.0.1:18121 status adminsecret |  grep "FreeRADIUS-Total-Proxy-Access-Accepts" | rev |cut -d ' ' -f 1 | rev
UserParameter=radius.proxyauth_access_rejects,echo "Message-Authenticator = 0x00, FreeRADIUS-Statistics-Type = 4" | radclient -x 127.0.0.1:18121 status adminsecret |  grep "FreeRADIUS-Total-Proxy-Access-Rejects" | rev |cut -d ' ' -f 1 | rev
UserParameter=radius.proxyauth_access_challenges,echo "Message-Authenticator = 0x00, FreeRADIUS-Statistics-Type = 4" | radclient -x 127.0.0.1:18121 status adminsecret |  grep "FreeRADIUS-Total-Proxy-Access-Challenges" | rev |cut -d ' ' -f 1 | rev
UserParameter=radius.proxyauth_auth_responses,echo "Message-Authenticator = 0x00, FreeRADIUS-Statistics-Type = 4" | radclient -x 127.0.0.1:18121 status adminsecret |  grep "FreeRADIUS-Total-Proxy-Auth-Responses" | rev |cut -d ' ' -f 1 | rev
UserParameter=radius.proxyauth_auth_duplicate_requests,echo "Message-Authenticator = 0x00, FreeRADIUS-Statistics-Type = 4" | radclient -x 127.0.0.1:18121 status adminsecret |  grep "FreeRADIUS-Total-Proxy-Auth-Duplicate-Requests" | rev |cut -d ' ' -f 1 | rev
UserParameter=radius.proxyauth_auth_malformed_requests,echo "Message-Authenticator = 0x00, FreeRADIUS-Statistics-Type = 4" | radclient -x 127.0.0.1:18121 status adminsecret |  grep "FreeRADIUS-Total-Proxy-Auth-Malformed-Requests" | rev |cut -d ' ' -f 1 | rev
UserParameter=radius.proxyauth_auth_invalid_requests,echo "Message-Authenticator = 0x00, FreeRADIUS-Statistics-Type = 4" | radclient -x 127.0.0.1:18121 status adminsecret |  grep "FreeRADIUS-Total-Proxy-Auth-Invalid-Requests" | rev |cut -d ' ' -f 1 | rev
UserParameter=radius.proxyauth_dropped_requests,echo "Message-Authenticator = 0x00, FreeRADIUS-Statistics-Type = 4" | radclient -x 127.0.0.1:18121 status adminsecret |  grep "FreeRADIUS-Total-Proxy-Auth-Dropped-Requests" | rev |cut -d ' ' -f 1 | rev
UserParameter=radius.proxyauth_auth_unknown_types,echo "Message-Authenticator = 0x00, FreeRADIUS-Statistics-Type = 4" | radclient -x 127.0.0.1:18121 status adminsecret |  grep "FreeRADIUS-Total-Proxy-Auth-Unknown-Types" | rev |cut -d ' ' -f 1 | rev
